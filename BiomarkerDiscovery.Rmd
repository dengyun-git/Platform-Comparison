---
title: "<span style='color:navy'>Comparative Analysis of CSF Proteomics for Biomarker Discovery Across MS and Olink Platforms: Protein Differential Expression and Associations with Clinical Traits</span>"

# author: ""
# date: "`r Sys.Date()`"
output: 
  rmdformats::robobook:
    fig_width: 9
    toc_depth: 2
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo=FALSE, warning=FALSE, message=FALSE,
                      fig.width = 6, fig.height = 4,
                      cache=FALSE, cache.lazy = FALSE,
                      fig.align = 'center',
                      tidy.opts = list(width.cutoff = 80), 
                      tidy = TRUE)

library(kableExtra)
```

```{=html}
<style type="text/css">
.book .book-body .page-inner {
max-width: 1600px;
margin-left: auto;
margin-right: auto;
}
details > summary {
display: list-item;
}
</style>
```       

# 1 - Global Summary of the Setting of this Study

**1. Proteomic Platforms:**  
We analyzed proteomic data from three different platforms:  

- Olink. 
- Mass Spectrometry with bead depletion (BEADdel, referred to as BEADdel in this report).
- Mass Spectrometry without bead depletion (NONdel, referred to as NONdel in this report).

**2.Analytical Approaches:**  
Two complementary approaches were used to explore potential protein biomarkers: 

- Protein Differential Expression Analysis: Regression models with protein levels as the response variable.  
- Association Testing: Regression models with protein levels as the predictor variable.  

These approaches were chosen to capture different structural patterns in the proteomic data.

**3. Analysis Scope:**  

- Both differential expression analysis and association testing were performed separately for each platform and each clinical trait. 
- Statistical significance was defined as an adjusted p-value < 0.05, after correcting for multiple testing across all proteins evaluated.

**4. Clinical Variables:**  
The clinical variables included in this report are:  

- `"ALSvsHC"`, `"ALSvsDC"`, `"DCvsHC"`, `"ALSFRSR_FINE_MOTOR"`, `"ALSFRSR_GROSS_MOTOR"`, `"ALSFRSR_RATE"`, `"ECAS_SCORE"`  
- `"BULBARvSpinal"` – derived from `WEAKNESS_SITE`, where `"GENERALISED"`, `"LOWER LIMB"`, `"RESPIRATORY"`, `"TRUNCAL"`, and `"UPPER LIMB"` are grouped as `"Spinal"`  
- `"C9vsNonC9"` – derived from `PATHOGENIC_VARIANT`, where `"KIF5A", "MAPT", "SBMA", "SOD1", "SPG7", "TBK1"` are grouped as NonC9 carriers  
- `ALSFRSR_RATE` – log-transformed  
- `ECAS_SCORE` – Box-Cox transformed with a maximum value of 134  
- `ALSFRSR_FINE_MOTOR` and `ALSFRSR_GROSS_MOTOR` – Box-Cox transformed with a maximum value of 12

**5. Handling Missing Values and Confounders:**  

- Missing values were excluded on a per-regression basis.  
- Age and gender were included as confounding factors in all regression models.

**6. Pathway Enrichment Testing:**  

- Performed per platform and per clinical trait.  
- The pathway databases included are: `"GOBP"`, `"GOMF"`, `"GOCC"`, `"REACTOME"`, `"KEGG"`, `"Biocarta"`, and `"WikiPathways"`.  
- Ranked Gene Set Enrichment Testing was adopted, using the ranking metric:  
\[
\text{Rank} = -\log(p) \times \text{sign}(\beta)
\]  
where `p` and `β` are derived from the respective regression model.

# 2 - The Key Insights So Far

## **2.1 Biomarker Candidate**

<b><font face="Georgia" size="3em" color="firebrick"> Note: Section 7.1 (“Details for each biomarker candidate”) offers a convenient way to compare biomarkers identified across platforms.</font></b>

- NONdel and Olink have more consistent conclusions about the biomarker candidates. 

- CHI3L1: emerged as the only marker consistently detected across all platforms, supporting its well-established role in inflammation, tissue remodeling, and fibrotic processes. 

- CA3, CD84, CFD, CHIT1, GAPDH, GPNMB, LGALS3BP, ORM1, PROS1, SERPINA3, SOD3: 11 proteins showed concordant results between the NONdel and Olink platforms. These proteins largely represent inflammatory mediators, acute-phase reactants, metabolic regulators, and extracellular enzymes.

- ANGPTL4: uniquely consistent between the BEADdel and Olink platforms and is notable for its established involvement in lipid metabolism, hypoxia responses, and vascular regulation. 

- ALNT15: uniquely consistent between BEADdel and NONdel, representing a a emerging relevance in secretory pathway regulation and adipogenesis.


## **2.2 Pathway Enrichment Findings**

<b><font face="Georgia" size="3em" color="firebrick"> Note: The following provides example analytical conclusions based on Section 6. Additional insights can be explored further within that section.</font></b>

### **ALS vs Healthy Controls (ALSvsHC)**

- **Olink:**  Strong enrichment of **neuronal pathways**, especially those related to **axonogenesis**, **neuronal differentiation**, and **neuroprotection**, suggesting that Olink preferentially detects neuronal structural changes relevant to ALS.

- **BEADdel:**  Pathways are dominated by **innate immune activation**, **defense responses**, and **synapse/cell-junction organization**, as well as **glycan metabolic processes**, indicating a tendency toward capturing inflammatory and structural remodeling biology.

- **NONdel:**  Shows broad enrichment across **neurodevelopment**, **axon guidance**, **cell morphogenesis**, and **immune and extracellular vesicle–related processes**, reflecting a mixture of neuronal, immune, and vesicle-mediated biology.

### **Bulbar vs Spinal Presentation**

- Only **Olink** shows enriched pathways for this comparison. Implicated biology points to **immune and secretory vesicle–related processes**, but replication across platforms is not observed.

### **C9 vs Non-C9 Genotype**

- **BEADdel and NONdel** overlap in **ECM and structural pathways**, suggesting genotype-specific ECM remodeling. 

- **Olink** instead highlights **protein degradation**, aligning with established C9orf72 biology.  

### **ALS Fine Motor Scores**

- **Olink and NONdel** show strong convergence on **neuronal and synaptic pathways**. 

- **NONdel and BEADdel** share enrichment in **immune pathways**, though signals are weaker in BEADdel.  

### **ECAS Score (Cognition)**

- **NONdel:**  
  Enrichment in **negative regulation of intracellular signaling**, suggesting roles for intracellular pathway modulation in cognitive function.

- **BEADdel:**  
  Enrichment at the **cytoplasmic side of the plasma membrane**, potentially implicating membrane-associated signaling or receptor complexes.

- **Olink:**  
  Enriched for pathways involving the **endoplasmic reticulum lumen**, **extracellular matrix**, **encapsulating structures**, **cell body**, and **vesicle lumen**, indicating involvement of **secretory pathways, ECM organization, and vesicle trafficking**.


# 3 - Overlap for Samples and Proteins{.tabset}

<b><font face="Georgia" size="3em" color="firebrick"> Note: The overlapping are based on MS and Olink data sets after quality control and only the baseline samples are included in the analysis for this report.</font></b>

```{r, Load Data, echo=FALSE, warning=FALSE, message=FALSE, results=F}
library(kableExtra)
library(plotly)
library(DT)
library(stringr)
library(tidyverse)

inputPath <- "/home/rstudio/workspace/Data Collection/"
intermediatePath1 <- "/home/rstudio/workspace/Data Collection/intermediate_AssociationTesting/"
intermediatePath2 <- "/home/rstudio/workspace/Data Collection/intermediate_DifferentialExpression/"
outPath1 <- "/home/rstudio/workspace/Data Collection/output_AssociationTesting/"
outPath2 <- "/home/rstudio/workspace/Data Collection/output_DifferentialExpression/"
outPath <- "/home/rstudio/workspace/Data Collection/output_report/"

source("/home/rstudio/repos/DE_functions_call.R")

load(file = paste0(inputPath, "output_report/Load_Data_For_Report.rdata"))

platformList <- c("Olink", "BEADdel", "NONdel")

varAll_List <- c("ALSvsHC", "ALSvsDC", "DCvsHC", "BULBARvSpinal", "C9vsNonC9", "ALSFRSR_FINE_MOTOR", "ALSFRSR_GROSS_MOTOR", "ALSFRSR_RATE", "ECAS_SCORE")

varList_Conf <- c("AGE_AT_SYMPTOM_ONSET", "AGE_AT_SAMPLING","GENDER", "COHORT")
```

## 3.1 - Proteins{.tabset}

```{r, echo=FALSE, warning=FALSE, message=FALSE}
set_list <- list(
  "Olink" = colnames(Olink_ProF_matchClinic),
  "BEADdel" = colnames(BEADdel_ProF_matchClinic),
  "NONdel" = colnames(NONdel_ProF_matchClinic)
)

elements <- unique(unlist(set_list))  # Extract all unique elements from sets

binary_matrix <- as.data.frame(
  sapply(set_list, function(x) elements %in% x)
)
rownames(binary_matrix) <- elements
colnames(binary_matrix) <- names(set_list)

ComplexUpset::upset(
  binary_matrix,
  intersect = names(set_list),
  name = "Proteins in Platforms"
)
```


## 3.2 - Samples{.tabset}

```{r, echo=FALSE, warning=FALSE, message=FALSE}
set_list <- list(
  "Olink" = rownames(Olink_ProF_matchClinic),
  "BEADdel" = rownames(BEADdel_ProF_matchClinic),
  "NONdel" = rownames(NONdel_ProF_matchClinic)
)

elements <- unique(unlist(set_list))  
binary_matrix <- as.data.frame(
  sapply(set_list, function(set) elements %in% set)  
)
rownames(binary_matrix) <- elements  
colnames(binary_matrix) <- names(set_list) 

ComplexUpset::upset(
  binary_matrix,
  intersect = names(set_list),  
  name = "Samples in Platformss"  
)
```

# 4 - Clinincal Traits View
```{r, echo=FALSE, warning=FALSE, message=FALSE, fig.width=15, fig.height=12}
load(file = paste0(intermediatePath1, "ClinicVar_View.Rdata"))
All_ClinicVar_View
```

# 5 - Volcano Plot{.tabset}
These volcano plots are based on the protein coefficients and adjusted p-values obtained from the association testing models for each clinical trait.  

The reference groups for each categorical trait are as follows:

- ALSvsHC: reference group = HEALTHY CONTROL  
- DCvsHC: reference group = HEALTHY CONTROL  
- ALSvsDC: reference group = DISEASE CONTROL  
- BULBARvSpinal: reference group = BULBAR 
- C9vsNonC9: reference group = C9ORF72

```{r, results='asis', echo=FALSE, warning=FALSE, message=FALSE}

# Load plots
load(paste0(intermediatePath1, "volcano_panel_list.rdata"))
load(paste0(intermediatePath1, "plotly_volcano_list.rdata"))

for (trait in varAll_List) {
  
  out <- NULL
  
  # --- Chunk for static volcano plot ---
  uniq_id <- sample(1e6, 1)
  out <- knitr::knit_expand(text = c(
    paste0("## ", trait, "\n\n"),  # tab header for trait
    paste0("```{r StaticVolcano_", trait, "_", uniq_id, ", echo=FALSE, fig.width=15, fig.height=8}"),
    paste0("print(volcano_panel_list[['", trait, "']])"),
    "```"
  ))
  
  # --- Chunks for interactive plots ---
  for (plat in platformList) {
    uniq_id2 <- sample(1e6, 1)
    
    out <- c(out, knitr::knit_expand(text = c(
      "<div style='text-align: center;'>",  # start centering
      paste0("```{r InteractiveVolcano_", trait, "_", plat, "_", uniq_id2, 
             ", echo=FALSE, fig.width=8, fig.height=5}"),
      paste0("plotly_volcano_list[['", trait, "']][['", plat, "']]"),
      "```",
      "</div>"  # end centering
    )))
  }
  
  # Knit the child text to produce actual evaluated chunks
  cat(knitr::knit_child(text = out, quiet = TRUE), sep = "\n")
}

```

# 6 - Pathway Enrichment Testing{.tabset}

For each pathway database, gene set size between 10 and 1000 (inclusive) were included in the Gene Set Enrichment Analysis (GSEA).

- Only pathways meeting the significance threshold (padj < 0.05) are displayed. Point size represents −log(p-value), and color corresponds to the NES.
- Positive NES with significant adjusted p-value (padj) indicates that the pathway is activated/upregulated in the condition of interest.  
- Negative NES with significant padj indicates that the pathway is suppressed/downregulated.  
- Leading edge proteins are the subset of proteins driving the significance of the corresponding pathways.
- Blank indicates that no significantly enriched pathways were identified.
- The first-level tabs correspond to clinical traits. Within each clinical trait tab, there are second-level tabs corresponding to the different pathway databases referenced to.

# 6.1 - Pathway Enrichment Analysis Based on Association Testing, Using Proteins as Predictors{.tabset}
```{r pathway_plots_nested_tabs, results='asis', echo=FALSE, warning=FALSE, message=FALSE}
# Load pre-generated Plotly objects
load(paste0(outPath1, "ply_list.rdata"))

pathBaseList <- c("GOBP", "GOMF", "GOCC", "REACTOME", "KEGG", "Biocarta", "WikiPathways")

for (trait in varAll_List) {
  
  out <- NULL
  
  # ---- FIRST-LEVEL TAB: Clinical Trait ----
  # Add {.tabset} to enable second-level tabs
  out <- knitr::knit_expand(text = c(
    paste0("## ", trait, " {.tabset}\n\n")
  ))
  
  for (db in pathBaseList) {
    
    # ---- SECOND-LEVEL TAB: Database ----
    out <- c(out, knitr::knit_expand(text = c(
      paste0("### ", db, "\n\n")
    )))
    
    # Find matching entry in ply_list
    ply_pattern <- paste0(db, "_", trait)
    idx <- grep(ply_pattern, names(ply_list))
    
    if(length(idx) > 0) {
      key <- names(ply_list)[idx[1]]  # take first match
      chunk_label <- paste0("PlotChunk_", trait, "_", db, "_", sample(1e6, 1))  # unique label
      
      # Add the plot chunk
      out <- c(out, knitr::knit_expand(text = c(
        "<div style='text-align:center;'>",
        paste0("```{r ", chunk_label, ", echo=FALSE, fig.width=10, fig.height=10}"),
        paste0("ply_list[['", key, "']]"),
        "```",
        "</div>"
      )))
    } else {
      warning(paste0("No plot found for ", db, "_", trait))
    }
  }
  
  # Render all chunks for this trait tab
  cat(knitr::knit_child(text = out, quiet = TRUE), sep = "\n")
}
```

# 6.2 - Pathway Enrichment Analysis Based on Differential Expression, Using Proteins as Response Variables{.tabset}
```{r, results='asis', echo=FALSE, warning=FALSE, message=FALSE}
load(paste0(outPath2, "ply_list.rdata"))

for (trait in varAll_List) {
  
  out <- NULL
  
  # ---- FIRST-LEVEL TAB: Clinical Trait ----
  # Add {.tabset} to enable second-level tabs
  out <- knitr::knit_expand(text = c(
    paste0("## ", trait, " {.tabset}\n\n")
  ))
  
  for (db in pathBaseList) {
    
    # ---- SECOND-LEVEL TAB: Database ----
    out <- c(out, knitr::knit_expand(text = c(
      paste0("### ", db, "\n\n")
    )))
    
    # Find matching entry in ply_list
    ply_pattern <- paste0(db, "_", trait)
    idx <- grep(ply_pattern, names(ply_list))
    
    if(length(idx) > 0) {
      key <- names(ply_list)[idx[1]]  # take first match
      chunk_label <- paste0("PlotChunk_", trait, "_", db, "_", sample(1e6, 1))  # unique label
      
      # Add the plot chunk
      out <- c(out, knitr::knit_expand(text = c(
        "<div style='text-align:center;'>",
        paste0("```{r ", chunk_label, ", echo=FALSE, fig.width=10, fig.height=10}"),
        paste0("ply_list[['", key, "']]"),
        "```",
        "</div>"
      )))
    } else {
      warning(paste0("No plot found for ", db, "_", trait))
    }
  }
  
  # Render all chunks for this trait tab
  cat(knitr::knit_child(text = out, quiet = TRUE), sep = "\n")
}
```

# 7 - Summary Table of Overlapping Biomarker Candidate{.tabset} 

# 7.1 - Combined Biomarker Candidate from Two Complemetary Approaches with Comparisons Acorss the Three Platforms {.tabset} 
## Clinical Trait vs Platform — Each Entry Represents A Set of Biomarker Candidates {.tabset} 
```{r, echo=FALSE, warning=FALSE, message=FALSE}
SigProSummary_AT <- read.csv(paste0(outPath1, "SigProSummary.csv"))
SigProSummary_DE <- read.csv(paste0(outPath2, "SigProSummary.csv"))

# Get all unique ClinicalVar from both data frames
all_clinical <- SigProSummary_AT$ClinicalVar

# Initialize an empty list to store results
result_list <- vector("list", length(all_clinical))

# Function to merge protein strings
merge_proteins <- function(a, b) {
  a <- ifelse(is.na(a), "", a)
  b <- ifelse(is.na(b), "", b)
  combined <- unique(unlist(str_split(c(a, b), "/")))
  combined <- combined[combined != ""]
  paste(combined, collapse = "/")
}

# Loop over all ClinicalVar
for (i in seq_along(all_clinical)) {
  var <- all_clinical[i]
  
  row_AT <- SigProSummary_AT %>% filter(ClinicalVar == var)
  row_DE <- SigProSummary_DE %>% filter(ClinicalVar == var)
  
  BEADdel <- merge_proteins(if(nrow(row_AT) > 0) row_AT$BEADdel else NA,
                            if(nrow(row_DE) > 0) row_DE$BEADdel else NA)
  
  NONdel  <- merge_proteins(if(nrow(row_AT) > 0) row_AT$NONdel else NA,
                            if(nrow(row_DE) > 0) row_DE$NONdel else NA)
  
  Olink   <- merge_proteins(if(nrow(row_AT) > 0) row_AT$Olink else NA,
                            if(nrow(row_DE) > 0) row_DE$Olink else NA)
  
  result_list[[i]] <- data.frame(
    ClinicalVar = var,
    BEADdel = BEADdel,
    NONdel  = NONdel,
    Olink   = Olink,
    stringsAsFactors = FALSE
  )
}

# Combine into final data frame
SigProSummary <- bind_rows(result_list)

# View result
DT::datatable(SigProSummary)
```

## Overlap Across Platforms {.tabset} 
```{r, echo=FALSE, warning=FALSE, message=FALSE}
OverlapTable_All <- GetOverlapTable(varAll_List, SigProSummary)
DT::datatable(OverlapTable_All)

split_proteins <- function(x) {
  if (is.na(x) || x == "") return(character(0))
  v <- unlist(str_split(x, "/", simplify = FALSE))
  v <- trimws(v)
  v <- v[v != "" & !is.na(v)]
  unique(v)
}

# Extract proteins from all three columns
all_proteins_list <- lapply(SigProSummary %>% dplyr::select(BEADdel, NONdel, Olink),
                            function(col) unlist(lapply(col, split_proteins)))

# Combine and get unique proteins
SigPro_List <- unique(unlist(all_proteins_list))

```

## Details for each biomarker candidate {.tabset}
```{r, echo=FALSE, warning=FALSE, message=FALSE}
# helper to split slash-delimited protein strings
split_proteins <- function(x) {
  if (is.null(x) || all(is.na(x))) return(character(0))
  x <- as.character(x)
  # handle vector, collapse first (in case of multiple entries)
  x <- paste(x, collapse = "/")
  v <- unlist(str_split(x, "/", simplify = FALSE))
  v <- trimws(v)
  v <- v[v != "" & !is.na(v) & v != "NA"]
  unique(v)
}

# get lists of significant proteins from SigProSummary (any ClinicalVar)
sig_in_olink  <- unique(unlist(lapply(SigProSummary$Olink,  split_proteins)))
sig_in_bead   <- unique(unlist(lapply(SigProSummary$BEADdel, split_proteins)))
sig_in_nondel <- unique(unlist(lapply(SigProSummary$NONdel,  split_proteins)))

# all proteins list (you may already have SigPro_List)
SigPro_List <- sort(unique(SigPro_List))

# create an empty results data.frame, with placeholders
res_df <- data.frame(
  Protein = SigPro_List,
  Exist_in_Olink     = NA_character_,
  Exist_in_BEADdel   = NA_character_,
  Exist_in_NONdel    = NA_character_,
  Significant_in_Olink   = NA_character_,
  Significant_in_BEADdel = NA_character_,
  Significant_in_NONdel  = NA_character_,
  Corr_Olink_BEADdel = NA_real_,        
  Corr_Olink_NONdel  = NA_real_,        
  Corr_BEADdel_NONdel = NA_real_,      
  `DilutionBin_Olink (A~D: high → low abundance)` = NA_character_,  
  Protein_Detectability_Olink_percent = NA_character_,              
  stringsAsFactors = FALSE,
  check.names = FALSE
)

# fill existence columns based on whether protein name appears in the expression data column names

for (i in seq_len(nrow(res_df))) {
  p <- res_df$Protein[i]
  res_df$Exist_in_Olink[i]   <- if (p %in% colnames(Olink_ProF))   "YES" else "NO"
  res_df$Exist_in_BEADdel[i] <- if (p %in% colnames(BEADdel_ProF)) "YES" else "NO"
  res_df$Exist_in_NONdel[i]  <- if (p %in% colnames(NONdel_ProF))  "YES" else "NO"
  
  # significant: check whether protein appears anywhere in SigProSummary's Olink/BEADdel/NONdel lists
  res_df$Significant_in_Olink[i]   <- if (p %in% sig_in_olink)  "YES" else "NO"
  res_df$Significant_in_BEADdel[i] <- if (p %in% sig_in_bead)   "YES" else "NO"
  res_df$Significant_in_NONdel[i]  <- if (p %in% sig_in_nondel) "YES" else "NO"
}


# Function to compute correlation coefficient between pairwise platforms
compute_corr <- function(protein, df1, df2) {
  # Find common samples
  commonSamp <- intersect(rownames(df1), rownames(df2))
  
  # Subset to common samples
  df1 <- df1[commonSamp, , drop = FALSE]
  df2 <- df2[commonSamp, , drop = FALSE]
  
  # Check protein exists in both datasets
  if (!(protein %in% colnames(df1)) || !(protein %in% colnames(df2))) return(NA_real_)
  
  # Extract vectors
  x <- df1[, protein]
  y <- df2[, protein]
  
  # Compute correlation, ignoring NA
  signif(cor(x, y, use = "pairwise.complete.obs"), digits=4)
}

res_df$Corr_Olink_BEADdel <- sapply(res_df$Protein, compute_corr,
                                    df1 = Olink_ProF_matchClinic,
                                    df2 = BEADdel_ProF_matchClinic)

res_df$Corr_Olink_NONdel <- sapply(res_df$Protein, compute_corr,
                                   df1 = Olink_ProF_matchClinic,
                                   df2 = NONdel_ProF_matchClinic)

res_df$Corr_BEADdel_NONdel <- sapply(res_df$Protein, compute_corr,
                                     df1 = BEADdel_ProF_matchClinic,
                                     df2 = NONdel_ProF_matchClinic)

# Make sure types are consistent
res_df <- res_df %>%
  mutate(
    Exist_in_Olink = as.character(Exist_in_Olink),
    Exist_in_BEADdel = as.character(Exist_in_BEADdel),
    Exist_in_NONdel = as.character(Exist_in_NONdel),
    Significant_in_Olink = as.character(Significant_in_Olink),
    Significant_in_BEADdel = as.character(Significant_in_BEADdel),
    Significant_in_NONdel = as.character(Significant_in_NONdel)
  )

# Read in the detectability information
Raw_Olink_CSF <- read.csv("/home/rstudio/workspace/Data Collection/Data-CSF/oxf-da28-opdc-als-multiple-cohorts-olink-csf/P230192_CSP1-5_CINO_and_C2I2N2O2_EXTENDED_NPX_2024-01-18_cleaned.csv", sep = ";")

# Load LOD for proteins
LOD_sigPro <- Raw_Olink_CSF[unlist(sapply(SigPro_List, function(x) {which(Raw_Olink_CSF$Assay == x)[1]})), "LOD"]
names(LOD_sigPro) <- SigPro_List

# Calculate detectability per protein across samples
res_df$Protein_Detectability_Olink_percent <- round(100 * sapply(SigPro_List, function(x) {
  if (!(x %in% colnames(Olink_ProF_matchClinic))) return(NA_real_)
  sum(Olink_ProF_matchClinic[, x] > LOD_sigPro[x], na.rm = TRUE) / nrow(Olink_ProF_matchClinic)
}), 2)

# Read in Dilution Bins
res_df$`DilutionBin_Olink (A~D: high → low abundance)` <- sapply(res_df$Protein, function(x){Raw_Olink_CSF$Block[which(Raw_Olink_CSF$Assay == x)[1]]})

# View interactive table
DT::datatable(res_df, options = list(pageLength = 30), rownames = FALSE, filter = "top")

```

# 7.2 - Biomarker Candidate Derived from Association Testing with Comparisons Across the Three Platforms {.tabset} 
## Clinical Trait vs Platform — Each entry represents a set of biomarker candidates{.tabset} 
```{r, echo=FALSE, warning=FALSE, message=FALSE}
DT::datatable(SigProSummary_AT, filter = "top")
```
## Overlap Across Platforms {.tabset} 
```{r, echo=FALSE, warning=FALSE, message=FALSE}
summary_df_AT <- read.csv(paste0(outPath1, "overlap_summary_counts.csv"))
OverlapTable_AT <- GetOverlapTable(varAll_List, SigProSummary_AT)
DT::datatable(OverlapTable_AT, filter = "top")
```

# 7.3 - Biomarker Candidate Derived from Differential Expression with Comparisons Across the Three Platforms {.tabset} 
## Clinical Trait vs Platform — Each entry represents a set of biomarker candidates{.tabset} 
```{r, warning=FALSE, message=FALSE}
DT::datatable(SigProSummary_DE, filter = "top")
```
## Overlap Across Platforms {.tabset} 
```{r, echo=FALSE, warning=FALSE, message=FALSE}
summary_df_DE <- read.csv(paste0(outPath2, "overlap_summary_counts.csv"))
OverlapTable_DE <- GetOverlapTable(varAll_List, SigProSummary_DE)
DT::datatable(OverlapTable_DE, filter = "top")
```
